"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useObjectEditFormBuilderFocus = useObjectEditFormBuilderFocus;

var _portableTextEditor = require("@sanity/portable-text-editor");

var _react = require("react");

var onBlur = () => {// We don't need to act on these.
};

function useObjectEditFormBuilderFocus(onFocus) {
  var editor = (0, _portableTextEditor.usePortableTextEditor)();
  var selection = (0, _portableTextEditor.usePortableTextEditorSelection)();
  var onEditObjectFormBuilderFocus = (0, _react.useCallback)(nextPath => {
    if (selection) {
      _portableTextEditor.PortableTextEditor.blur(editor);
    }

    onFocus(nextPath);
  }, [editor, onFocus, selection]);
  var onEditObjectFormBuilderBlur = onBlur;
  var onEditObjectClose = (0, _react.useCallback)(() => {
    if (selection) {
      _portableTextEditor.PortableTextEditor.focus(editor); // Not sure why, but Safari resets the selection for some reason if the path isn't emitted as a new object here.


      onFocus([...selection.focus.path]);
    } else {
      onFocus([]);

      _portableTextEditor.PortableTextEditor.focus(editor);
    }
  }, [editor, onFocus, selection]);
  return (0, _react.useMemo)(() => ({
    onEditObjectFormBuilderFocus,
    onEditObjectFormBuilderBlur,
    onEditObjectClose
  }), [onEditObjectFormBuilderBlur, onEditObjectFormBuilderFocus, onEditObjectClose]);
}